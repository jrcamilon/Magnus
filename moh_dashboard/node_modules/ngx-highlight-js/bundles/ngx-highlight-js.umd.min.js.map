{"version":3,"sources":["ng://ngx-highlight-js/src/highlight-js.directive.ts","ng://ngx-highlight-js/src/highlight-js.module.ts"],"names":["HighlightJsDirective","el","doc","this","prototype","escapeHTML","str","replace","init","destroy","codeEl","createElement","lang","className","innerHTML","code","nativeElement","trim","parentEl","parentNode","insertBefore","nextSibling","hljs","configure","Object","assign","options","highlightBlock","removeChild","ngOnInit","ngAfterViewInit","_this","ngModel","valueChanges","subscribe","res","initMutation","ngOnDestroy","destroyMutation","MutationObserver","observer","bind","observe","characterData","childList","subtree","disconnect","Directive","args","selector","host","style","ElementRef","Inject","DOCUMENT","Input","ContentChild","NgModel","HighlightJsModule","NgModule","imports","FormsModule","declarations","exports"],"mappings":"kZAiEE,SAAAA,EAAoBC,EAA0CC,GAA1CC,KAAAF,GAAAA,EAA0CE,KAAAD,IAAAA,EAyChE,OAxEUF,EAAAI,UAAAC,WAAR,SAAmBC,GACjB,OAAQA,GAAO,IACZC,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,UACdA,QAAQ,KAAM,WAGXP,EAAAI,UAAAI,KAAR,WACEL,KAAKM,UACLN,KAAKO,OAASP,KAAKD,IAAIS,cAAc,OACjCR,KAAKS,OACPT,KAAKO,OAAOG,UAAYV,KAAKS,MAE/BT,KAAKO,OAAOI,UACVX,KAAKY,MAAQ,GAAKZ,KAAKF,GAAGe,cAAcF,UAAUG,OACpDd,KAAKe,SAAWf,KAAKF,GAAGe,cAAcG,WACtChB,KAAKe,SAASE,aAAajB,KAAKO,OAAQP,KAAKF,GAAGe,cAAcK,aAE9DC,KAAKC,UAAUC,OAAOC,OAAO,GAAItB,KAAKuB,UACtCJ,KAAKK,eAAexB,KAAKO,SAGnBV,EAAAI,UAAAK,QAAR,WACMN,KAAKO,SACPP,KAAKe,SAASU,YAAYzB,KAAKO,QAC/BP,KAAKO,OAAS,OAMlBV,EAAAI,UAAAyB,SAAA,WACE1B,KAAKK,QAGPR,EAAAI,UAAA0B,gBAAA,WAAA,IAAAC,EAAA5B,KACMA,KAAK6B,QACP7B,KAAK6B,QAAQC,aAAaC,UAAU,SAAAC,GAClCJ,EAAKhB,KAAOgB,EAAK1B,WAAW8B,GAC5BJ,EAAKvB,SAGPL,KAAKiC,gBAITpC,EAAAI,UAAAiC,YAAA,WACElC,KAAKM,UACLN,KAAKmC,mBAMCtC,EAAAI,UAAAgC,aAAR,WACkC,oBAArBG,mBACXpC,KAAKqC,SAAW,IAAID,iBAAiBpC,KAAKK,KAAKiC,KAAKtC,OACpDA,KAAKqC,SAASE,QAAQvC,KAAKF,GAAGe,cAAe,CAC3C2B,eAAe,EACfC,WAAW,EACXC,SAAS,MAIL7C,EAAAI,UAAAkC,gBAAR,WACOnC,KAAKqC,UACVrC,KAAKqC,SAASM,kCAvFjBC,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,iBACVC,KAAM,CACJC,MAAO,8DAhBTC,EAAAA,8CA+DqCC,EAAAA,OAAML,KAAA,CAACM,EAAAA,gDA3C3CC,EAAAA,oBAEAA,EAAAA,oBAEAA,EAAAA,uBAEAC,EAAAA,aAAYR,KAAA,CAACS,EAAAA,YA8EhBzD,kBCtGA,SAAA0D,KAMA,2BANCC,EAAAA,SAAQX,KAAA,CAAC,CACRY,QAAS,CAACC,EAAAA,aACVC,aAAc,CAAC9D,GACf+D,QAAS,CAAC/D,OAGZ0D","sourcesContent":["import {\r\n  Directive,\r\n  ElementRef,\r\n  Input,\r\n  OnInit,\r\n  OnDestroy,\r\n  ContentChild,\r\n  AfterViewInit,\r\n  Inject,\r\n} from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { NgModel } from '@angular/forms';\r\n\r\ndeclare const hljs: any;\r\n\r\n@Directive({\r\n  selector: '[highlight-js]',\r\n  host: {\r\n    style: 'display:none;',\r\n  },\r\n})\r\nexport class HighlightJsDirective implements OnInit, AfterViewInit, OnDestroy {\r\n  @Input()\r\n  options: any;\r\n  @Input()\r\n  lang: string;\r\n  @Input()\r\n  code: string;\r\n  @ContentChild(NgModel)\r\n  private readonly ngModel: NgModel;\r\n\r\n  protected codeEl: any;\r\n  protected parentEl: any;\r\n\r\n  private escapeHTML(str: string): string {\r\n    return (str || '')\r\n      .replace(/&/g, '&amp;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;')\r\n      .replace(/\"/g, '&quot;')\r\n      .replace(/'/g, '&apos;');\r\n  }\r\n\r\n  private init() {\r\n    this.destroy();\r\n    this.codeEl = this.doc.createElement('pre');\r\n    if (this.lang) {\r\n      this.codeEl.className = this.lang;\r\n    }\r\n    this.codeEl.innerHTML =\r\n      this.code || '' + this.el.nativeElement.innerHTML.trim();\r\n    this.parentEl = this.el.nativeElement.parentNode;\r\n    this.parentEl.insertBefore(this.codeEl, this.el.nativeElement.nextSibling);\r\n\r\n    hljs.configure(Object.assign({}, this.options));\r\n    hljs.highlightBlock(this.codeEl);\r\n  }\r\n\r\n  private destroy() {\r\n    if (this.codeEl) {\r\n      this.parentEl.removeChild(this.codeEl);\r\n      this.codeEl = null;\r\n    }\r\n  }\r\n\r\n  constructor(private el: ElementRef, @Inject(DOCUMENT) private doc: any) {}\r\n\r\n  ngOnInit() {\r\n    this.init();\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    if (this.ngModel) {\r\n      this.ngModel.valueChanges.subscribe(res => {\r\n        this.code = this.escapeHTML(res);\r\n        this.init();\r\n      });\r\n    } else {\r\n      this.initMutation();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy();\r\n    this.destroyMutation();\r\n  }\r\n\r\n  // #region Mutation\r\n\r\n  private observer: MutationObserver;\r\n  private initMutation() {\r\n    if (typeof MutationObserver === 'undefined') return;\r\n    this.observer = new MutationObserver(this.init.bind(this));\r\n    this.observer.observe(this.el.nativeElement, {\r\n      characterData: true,\r\n      childList: true,\r\n      subtree: true,\r\n    });\r\n  }\r\n\r\n  private destroyMutation() {\r\n    if (!this.observer) return;\r\n    this.observer.disconnect();\r\n  }\r\n\r\n  // #endregionn\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { HighlightJsDirective } from './highlight-js.directive';\n\n@NgModule({\n  imports: [FormsModule],\n  declarations: [HighlightJsDirective],\n  exports: [HighlightJsDirective]\n})\nexport class HighlightJsModule {\n}\n"]}